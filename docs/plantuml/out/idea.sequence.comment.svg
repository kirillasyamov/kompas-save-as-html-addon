<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="725px" preserveAspectRatio="none" style="width:1152px;height:725px;background:#FFFFFF;" version="1.1" viewBox="0 0 1152 725" width="1152px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="713.8477" style="stroke:#000000;stroke-width:1.0;" width="958.5" x="91" y="6"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="73" x="533.75" y="19.0698">document</text><rect fill="#FFFFFF" height="573.9897" style="stroke:#000000;stroke-width:1.0;" width="10" x="152.5" y="84.8286"/><rect fill="#FFFFFF" height="29.7993" style="stroke:#000000;stroke-width:1.0;" width="10" x="157.5" y="267.8252"/><rect fill="#FFFFFF" height="573.9897" style="stroke:#000000;stroke-width:1.0;" width="10" x="280" y="84.8286"/><rect fill="#FFFFFF" height="573.9897" style="stroke:#000000;stroke-width:1.0;" width="10" x="666.5" y="84.8286"/><rect fill="#FFFFFF" height="29.7993" style="stroke:#000000;stroke-width:1.0;" width="10" x="671.5" y="297.6245"/><rect fill="#FFFFFF" height="29.7993" style="stroke:#000000;stroke-width:1.0;" width="10" x="671.5" y="532.4204"/><rect fill="#FFFFFF" height="573.9897" style="stroke:#000000;stroke-width:1.0;" width="10" x="766.5" y="84.8286"/><rect fill="#FFFFFF" height="573.9897" style="stroke:#000000;stroke-width:1.0;" width="10" x="905.5" y="84.8286"/><rect fill="#FFFFFF" height="573.9897" style="stroke:#000000;stroke-width:1.0;" width="10" x="999.5" y="84.8286"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="45" x2="45" y1="74.8286" y2="667.8184"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="157" x2="157" y1="74.8286" y2="667.8184"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="285" x2="285" y1="74.8286" y2="667.8184"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="671.5" x2="671.5" y1="74.8286" y2="667.8184"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="771.5" x2="771.5" y1="74.8286" y2="667.8184"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="910.5" x2="910.5" y1="74.8286" y2="667.8184"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1004.5" x2="1004.5" y1="74.8286" y2="667.8184"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1100.5" x2="1100.5" y1="74.8286" y2="667.8184"/><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="50" x="20" y="42.814"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="36" x="27" y="63.8892">client</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="50" x="20" y="666.8184"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="36" x="27" y="687.8936">client</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="105" x="105" y="42.814"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="91" x="112" y="63.8892">Array&lt;SVG&gt;</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="105" x="105" y="666.8184"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="91" x="112" y="687.8936">Array&lt;SVG&gt;</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="40" x="265" y="42.814"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="26" x="272" y="63.8892">this</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="40" x="265" y="666.8184"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="26" x="272" y="687.8936">this</text><rect fill="#ADD8E6" height="48.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="66" x="638.5" y="25.7993"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="32" x="655.5" y="46.8745">note</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="52" x="645.5" y="63.8892">handler</text><rect fill="#ADD8E6" height="48.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="66" x="638.5" y="666.8184"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="32" x="655.5" y="687.8936">note</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="52" x="645.5" y="704.9082">handler</text><rect fill="#ADD8E6" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="74" x="734.5" y="42.814"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="60" x="741.5" y="63.8892">renderer</text><rect fill="#ADD8E6" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="74" x="734.5" y="666.8184"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="60" x="741.5" y="687.8936">renderer</text><rect fill="#90EE90" height="48.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="66" x="877.5" y="25.7993"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="52" x="884.5" y="46.8745">bottom</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="48" x="886.5" y="63.8892">canvas</text><rect fill="#90EE90" height="48.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="66" x="877.5" y="666.8184"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="52" x="884.5" y="687.8936">bottom</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="48" x="886.5" y="704.9082">canvas</text><rect fill="#90EE90" height="48.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="62" x="973.5" y="25.7993"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="41" x="984" y="46.8745">upper</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="48" x="980.5" y="63.8892">canvas</text><rect fill="#90EE90" height="48.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="62" x="973.5" y="666.8184"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="41" x="984" y="687.8936">upper</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="48" x="980.5" y="704.9082">canvas</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="60" x="1070.5" y="42.814"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="46" x="1077.5" y="63.8892">screen</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="60" x="1070.5" y="666.8184"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="46" x="1077.5" y="687.8936">screen</text><rect fill="#FFFFFF" height="573.9897" style="stroke:#000000;stroke-width:1.0;" width="10" x="152.5" y="84.8286"/><rect fill="#FFFFFF" height="29.7993" style="stroke:#000000;stroke-width:1.0;" width="10" x="157.5" y="267.8252"/><rect fill="#FFFFFF" height="573.9897" style="stroke:#000000;stroke-width:1.0;" width="10" x="280" y="84.8286"/><rect fill="#FFFFFF" height="573.9897" style="stroke:#000000;stroke-width:1.0;" width="10" x="666.5" y="84.8286"/><rect fill="#FFFFFF" height="29.7993" style="stroke:#000000;stroke-width:1.0;" width="10" x="671.5" y="297.6245"/><rect fill="#FFFFFF" height="29.7993" style="stroke:#000000;stroke-width:1.0;" width="10" x="671.5" y="532.4204"/><rect fill="#FFFFFF" height="573.9897" style="stroke:#000000;stroke-width:1.0;" width="10" x="766.5" y="84.8286"/><rect fill="#FFFFFF" height="573.9897" style="stroke:#000000;stroke-width:1.0;" width="10" x="905.5" y="84.8286"/><rect fill="#FFFFFF" height="573.9897" style="stroke:#000000;stroke-width:1.0;" width="10" x="999.5" y="84.8286"/><polygon fill="#000000" points="754.5,102.6279,764.5,106.6279,754.5,110.6279,758.5,106.6279" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="290" x2="760.5" y1="106.6279" y2="106.6279"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="213" x="297" y="101.8984">addEventListener("mousemove")</text><polygon fill="#000000" points="654.5,132.4272,664.5,136.4272,654.5,140.4272,658.5,136.4272" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="290" x2="660.5" y1="136.4272" y2="136.4272"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="213" x="297" y="131.6978">addEventListener("mousemove")</text><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1.0;" width="1140.5" x="5" y="157.4272"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1145.5" y1="157.4272" y2="157.4272"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1145.5" y1="160.4272" y2="160.4272"/><polygon fill="#000000" points="268,190.2266,278,194.2266,268,198.2266,272,194.2266" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="45" x2="274" y1="194.2266" y2="194.2266"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="84" x="52" y="189.4971">rotate model</text><polygon fill="#000000" points="893.5,220.0259,903.5,224.0259,893.5,228.0259,897.5,224.0259" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="776.5" x2="899.5" y1="224.0259" y2="224.0259"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="105" x="783.5" y="219.2964">render(position)</text><polygon fill="#000000" points="1088.5,234.0259,1098.5,238.0259,1088.5,242.0259,1092.5,238.0259" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="915.5" x2="1094.5" y1="238.0259" y2="238.0259"/><polygon fill="#000000" points="178.5,263.8252,168.5,267.8252,178.5,271.8252,174.5,267.8252" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="172.5" x2="665.5" y1="267.8252" y2="267.8252"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="215" x="184.5" y="263.0957">find(e =&gt; e.position == position)</text><polygon fill="#000000" points="659.5,293.6245,669.5,297.6245,659.5,301.6245,663.5,297.6245" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="162.5" x2="665.5" y1="297.6245" y2="297.6245"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="98" x="169.5" y="292.895">element || null</text><polygon fill="#000000" points="987.5,323.4238,997.5,327.4238,987.5,331.4238,991.5,327.4238" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="676.5" x2="993.5" y1="327.4238" y2="327.4238"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="191" x="683.5" y="322.6943">if (element) appear(element)</text><polygon fill="#000000" points="1088.5,337.4238,1098.5,341.4238,1088.5,345.4238,1092.5,341.4238" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="1009.5" x2="1094.5" y1="341.4238" y2="341.4238"/><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1.0;" width="1140.5" x="5" y="362.4238"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1145.5" y1="362.4238" y2="362.4238"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1145.5" y1="365.4238" y2="365.4238"/><polygon fill="#000000" points="268,395.2231,278,399.2231,268,403.2231,272,399.2231" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="45" x2="274" y1="399.2231" y2="399.2231"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="67" x="52" y="394.4937">draw note</text><polygon fill="#000000" points="654.5,425.0225,664.5,429.0225,654.5,433.0225,658.5,429.0225" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="290" x2="660.5" y1="429.0225" y2="429.0225"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="118" x="297" y="424.293">draw(parameters)</text><polygon fill="#000000" points="987.5,454.8218,997.5,458.8218,987.5,462.8218,991.5,458.8218" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="676.5" x2="993.5" y1="458.8218" y2="458.8218"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="58" x="683.5" y="454.0923">update()</text><polygon fill="#000000" points="1088.5,468.8218,1098.5,472.8218,1088.5,476.8218,1092.5,472.8218" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="1009.5" x2="1094.5" y1="472.8218" y2="472.8218"/><polygon fill="#000000" points="268,498.6211,278,502.6211,268,506.6211,272,502.6211" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="45" x2="274" y1="502.6211" y2="502.6211"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="35" x="52" y="497.8916">apply</text><polygon fill="#000000" points="659.5,528.4204,669.5,532.4204,659.5,536.4204,663.5,532.4204" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="290" x2="665.5" y1="532.4204" y2="532.4204"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="47" x="297" y="527.6909">apply()</text><polygon fill="#000000" points="173.5,558.2197,163.5,562.2197,173.5,566.2197,169.5,562.2197" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="167.5" x2="665.5" y1="562.2197" y2="562.2197"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="480" x="179.5" y="557.4902">push({svg: document.appendChild(canvasContext.getSVG()), position})</text><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1.0;" width="1140.5" x="5" y="583.2197"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1145.5" y1="583.2197" y2="583.2197"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1145.5" y1="586.2197" y2="586.2197"/><polygon fill="#000000" points="268,616.019,278,620.019,268,624.019,272,620.019" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="45" x2="274" y1="620.019" y2="620.019"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="31" x="52" y="615.2896">save</text><polygon fill="#000000" points="56,645.8184,46,649.8184,56,653.8184,52,649.8184" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="50" x2="279" y1="649.8184" y2="649.8184"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="211" x="62" y="645.0889">XMLSerializer.serializeToString()</text><!--MD5=[adf53627b43e8e77b396321bbf114952]
@startuml idea.sequence.comment
!theme plain

participant client

box document
participant "Array<SVG>" as svg 
participant this 
participant "note\nhandler" as handler #LightBlue
participant renderer #LightBlue
participant "bottom\ncanvas" as c1 #LightGreen
participant "upper\ncanvas" as c2 #LightGreen
end box

activate renderer
activate this
activate svg
activate c1
activate c2
activate handler
participant screen


this -> renderer : addEventListener("mousemove")
this -> handler : addEventListener("mousemove")
====
client -> this : rotate model
renderer -> c1 : render(position)
c1 -> screen

handler -> svg : find(e => e.position == position)
activate svg
svg -> handler : element || null
deactivate svg
activate handler
handler -> c2 : if (element) appear(element)
deactivate handler
c2 -> screen
====
client -> this : draw note
this -> handler : draw(parameters)
handler -> c2 : update()
c2 -> screen

client -> this : apply
this -> handler : apply()
activate handler
handler -> svg : push({svg: document.appendChild(canvasContext.getSVG()), position})
deactivate handler

====
client -> this : save
this - -> client : XMLSerializer.serializeToString()

@enduml

@startuml idea.sequence.comment







<style>
  root {
    BackgroundColor white
    FontColor black
    FontName Verdana
    HyperLinkColor blue
    LineColor black
    LineThickness 1
    Margin 5
  }
  caption {
    LineThickness 0
  }
  footer {
    LineThickness 0
  }
  header {
    LineThickness 0
  }
  node {
    MaximumWidth 300
  }
  title {
    FontSize 22
    LineThickness 0
  }
</style>

skinparam ArrowLollipopColor black
skinparam BackgroundColor white
skinparam DefaultFontName Verdana
skinparam DefaultMonospacedFontName Courier
skinparam LifelineStrategy nosolid
skinparam ParticipantPadding 10
skinparam SequenceLifeLineBorderColor black
skinparam Shadowing false
skinparam UseBetaStyle true

skinparam Activity {
  BackgroundColor white
  BarColor black
  BorderColor black
  FontColor black
  FontName Verdana
}
skinparam Boundary {
  FontColor black
}
skinparam Box {
  Padding 5
}
skinparam CircledCharacter {
  FontColor black
  FontName Courier
  Radius 9
}
skinparam Class {
  BackgroundColor white
  BorderColor black
  FontColor black
  FontName Verdana
}
skinparam ClassAttribute {
  FontColor black
  FontName Verdana
}
skinparam ClassStereotype {
  FontColor black
  FontName Verdana
}
skinparam Footer {
  FontColor black
  FontName Verdana
}
skinparam Header {
  FontColor black
  FontName Verdana
}
skinparam Hyperlink {
  Color blue
}
skinparam IconPackage {
  Color black
  BackgroundColor white
}
skinparam IconPrivate {
  Color black
  BackgroundColor white
}
skinparam IconProtected {
  Color black
  BackgroundColor white
}
skinparam IconPublic {
  Color black
  BackgroundColor white
}
skinparam Note {
  FontColor black
  FontName Verdana
}
skinparam Object {
  BorderColor black
}
skinparam Package {
  BorderColor black
  FontColor black
  FontName Verdana
}
skinparam State {
  BackgroundColor white
  BorderColor black
}
skinparam StereotypeA {
  BackgroundColor white
  BorderColor black
}
skinparam StereotypeC {
  BackgroundColor white
  BorderColor black
}
skinparam StereotypeE {
  BackgroundColor white
  BorderColor black
}
skinparam StereotypeI {
  BackgroundColor white
  BorderColor black
}
skinparam StereotypeN {
  BackgroundColor white
  BorderColor black
}
skinparam UseCaseStereoType {
  FontColor black
  FontName Verdana
}

participant client

box document
participant "Array<SVG>" as svg 
participant this 
participant "note\nhandler" as handler #LightBlue
participant renderer #LightBlue
participant "bottom\ncanvas" as c1 #LightGreen
participant "upper\ncanvas" as c2 #LightGreen
end box

activate renderer
activate this
activate svg
activate c1
activate c2
activate handler
participant screen


this -> renderer : addEventListener("mousemove")
this -> handler : addEventListener("mousemove")
====
client -> this : rotate model
renderer -> c1 : render(position)
c1 -> screen

handler -> svg : find(e => e.position == position)
activate svg
svg -> handler : element || null
deactivate svg
activate handler
handler -> c2 : if (element) appear(element)
deactivate handler
c2 -> screen
====
client -> this : draw note
this -> handler : draw(parameters)
handler -> c2 : update()
c2 -> screen

client -> this : apply
this -> handler : apply()
activate handler
handler -> svg : push({svg: document.appendChild(canvasContext.getSVG()), position})
deactivate handler

====
client -> this : save
this - -> client : XMLSerializer.serializeToString()

@enduml

PlantUML version 1.2022.7(Mon Aug 22 23:01:30 GMT+06:00 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1251
Language: ru
Country: RU
--></g></svg>